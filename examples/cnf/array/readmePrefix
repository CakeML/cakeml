Refinement of generic CNF functions to use arrays
