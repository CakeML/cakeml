INCLUDES =

all: $(DEFAULT_TARGETS) README.md
.PHONY: all

README.md: $(CAKEMLDIR)/developers/readme_gen readmePrefix $(wildcard *Script.sml *Lib.sml *Syntax.sml *.lem *.c *.cml */readmePrefix)
	$(protect $(CAKEMLDIR)/developers/lint_source) . && $(CAKEMLDIR)/developers/readme_gen

ARCH=x64
WORD_SIZE=64

all: cake-$(ARCH)-$(WORD_SIZE).tar.gz cake.S cake

#was: http://www.cse.chalmers.se/~myreen/cake-$(ARCH)-$(WORD_SIZE).tar.gz
cake-$(ARCH)-$(WORD_SIZE).tar.gz:
	curl -LO https://github.com/CakeML/cakeml/releases/latest/download/cake-$(ARCH)-$(WORD_SIZE).tar.gz

cake.S: cake-$(ARCH)-$(WORD_SIZE).tar.gz
	tar -xvzf cake-$(ARCH)-$(WORD_SIZE).tar.gz --strip-components 1

cake: cake.S
	make -f Makefile
